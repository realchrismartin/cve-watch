import {checkUserSession, getAccountSubscriptions} from "../service/AccountService";
import {AppThunk} from "../type/Action";

export const checkUserSessionAction = () : AppThunk => async dispatch => {
    return checkUserSession().then((res) => {
        return dispatch({type:"SET_ACCOUNT_SESSION"});
    }).catch((err) => {
        return dispatch({type:"CLEAR_ACCOUNT_SESSION"});
    });
}

export const updateAccountSubscriptionsAction = () : AppThunk => async dispatch => {

    //TODO: remove hardcoding
    return getAccountSubscriptions("fakeusername").then((res) => {
        return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[...res.data.subscriptions]});
    }).catch((err) => {
        console.log(err)
        return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[]}); 
    });
}

export const clearAccountSubscriptionsAction = () : AppThunk => async dispatch => {
    return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[]}); 
}

export const toggleSubscriptionOnAction = (subscription : string) : AppThunk => async dispatch => {
    return dispatch({type:"TOGGLE_SUBSCRIPTION_ON",subscription:subscription});
}

export const toggleSubscriptionOffAction = (subscription : string) : AppThunk => async dispatch => {
    return dispatch({type:"TOGGLE_SUBSCRIPTION_OFF",subscription:subscription});
}