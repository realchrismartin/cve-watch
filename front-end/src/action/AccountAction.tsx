import {checkUserSession, getAccountSubscriptions} from "../service/AccountService";
import {AppThunk} from "../type/Action";

export const checkUserSessionAction = () : AppThunk => async dispatch => {
    return checkUserSession().then((res) => {
        return dispatch({type:"SET_ACCOUNT_SESSION"});
    }).catch((err) => {
        return dispatch({type:"CLEAR_ACCOUNT_SESSION"});
    });
}

export const updateAccountSubscriptionsAction = (username : string) : AppThunk => async dispatch => {

    return getAccountSubscriptions(username).then((res) => {
        return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[...res.data.subscriptions]});
    }).catch((err) => {
        console.log(err)
        return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[]}); 
    });
}

export const clearAccountSubscriptionsAction = () : AppThunk => async dispatch => {
    return dispatch({type:"SET_ACCOUNT_SUBSCRIPTIONS",subscriptions:[]}); 
}
