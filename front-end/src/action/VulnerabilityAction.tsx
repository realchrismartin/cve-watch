import {getVulnerabilityData} from "../service/VulnerabilityService";
import {AppThunk} from "../type/Action";

/* Action which retrieves a page of vulnerability data from the server */
export const getVulnerabilitiesAction = (query : string, startAt : number, pageSize : number): AppThunk => async dispatch => {
    dispatch({ type:"SET_VULNERABILITIES_LOADING", loading: true });
    const data = await getVulnerabilityData(query,startAt,pageSize);
    dispatch({ type:"SET_VULNERABILITIES_LOADING", loading: false });

    return dispatch({type:"GET_VULNERABILITIES",results:data.results});
}

/* Action which clears all vulnerabilities from the Redux store */
export const clearVulnerabilitiesAction = () : AppThunk => async dispatch => {
    return dispatch({type:"CLEAR_VULNERABILITIES"});
}

export const setVulnerabilitiesLoadingAction = (loading: boolean) => {
    return {type:"SET_VULNERABILITIES_LOADING", loading};
}