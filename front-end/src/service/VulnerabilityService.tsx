import axios from "axios";
import baseURL from "../util/BaseURL";

/* VulnerabilityService.tsx 
Defines all services required to fulfill vulnerability-related actions defined in VulnerabilityAction*/

/* Get vulnerability data from the NVD CVE API given a query string list of keywords (this+that+....)  */
export async function getVulnerabilityData(query : string, startAt : number, pageSize : number) : Promise<any> {

    return new Promise((resolve,reject) => {
        axios.get(`${baseURL()}/vulnerabilities/?query=${query}&startAt=${startAt}&pageSize=${pageSize}`,{withCredentials:true}).then(res => {
            resolve(res.data);
        }).catch((err) => {
            reject(err);
        });
    });
}